<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>桜ヶ丘体育施設予約管理</title>
  <link th:href="@{/home.css}" rel="stylesheet">
</head>

<body>
<h1>桜ヶ丘体育施設予約管理</h1>

<div class="task_form">
  <h2>予約管理</h2>

  <form action="/add">
    <label>場所</label>
    <input name="place" type="text"/>
    <label>利用団体名</label>
    <input name="groupname" type="text"/>
    <label>開始日時</label>
    <input name="startdatetime" type="datetime-local" step="1800"/>
    <label>修了日時</label>
    <input name="enddatetime" type="datetime-local" step="1800"/>
    <input type="submit" vaule="登録" />
  </form>
</div>

<div class="tasklist">
  <h2>予約一覧</h2>
  <table border="1">
    <thead>
    <tr>
      <th class="hidden">ID</th>
      <th>場所</th>
      <th>利用団体名</th>
      <th width="150px">開始日時</th>
      <th width="100px">状態</th>
      <th></th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="task : ${taskList}">
      <td class="hidden" th:text="${task.id}"></td>
      <td th:text="${task.place}"></td>
      <td th:text="${task.groupname}"></td>
      <td width="100px" th:text="${task.startdatetime}"></td>
      <td width="100px" th:text="${task.enddatetime}"></td>
      <td width="50px" th:text="${task.done} ? '承認済': '未承認'"></td>
      <td width="50px">
        <button type="submit" id="update_button" onclick="
                                let row = this.parentElement.parentElement;
                                getElementById('update_id').value=row.cells[0].firstChild.data;
                                getElementById('update_place').value=row.cells[1].firstChild.data;
                                getElementById('update_groupname').value=row.cells[2].firstChild.data;
                                getElementById('update_startdatetime').value=row.cells[3].firstChild.data;
                                getElementById('update_enddatetime').value=row.cells[4].firstChild.data;
                                getElementById('update_status').selectedIndex=(row.cells[5].firstChild.data=='完了')?1:0;
                                var dialog = getElementById('updateDialog');
                                dialog.style.left = ((window.innerWidth - 500) / 2) + 'px';
                                dialog.style.display = 'block';
                            ">更新</button>
      </td>
      <td width="50px">
        <form action="/delete">
          <button type="submit" id="delete_button">削除</button>
          <input type="hidden" name="id" th:value="${task.id}" />
        </form>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div id="updateDialog">
  <div class="task_form">
    <h2>予約の更新</h2>
    <form action="/update">
      <input id="update_id" name="id" type="hidden" />
      <label>場所</label>
      <input id="update_place" name="place" type="text" />
      <label>利用団体名</label>
      <input id="update_groupname" name="groupname" type="text" />
      <label>開始日時</label>
      <input id="update_startdatetime" name="startdatetime" type="datetime-local" step="1800"/>
      <label>修了日時</label>
      <input id="update_enddatetime" name="enddatetime" type="datetime-local" step="1800"/>
      <label>状態</label>
      <select id="update_status" name="done">
        <option value="false">未承認</option>
        <option value="true">承認済</option>
      </select>
      <div>
        <button type="submit">更新</button>
        <button type="reset"
                onclick="getElementById('updateDialog').style.display='none';">
          キャンセル</button>
      </div>
    </form>
  </div>
</div>

</body>
</html>